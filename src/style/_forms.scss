/////////////////////////////////////////////////////////////
// Mixins

@mixin input-group-feedback($color, $icon) {
    position: relative; // in order to position absolute icon
    $color-rgba: rgba(red($color), green($color), blue($color), .6); // box shadow custom color
    $color-dark: darken($color, 15%);

    // override input element default state
    .form-control {
        border-color: $color;
        padding-right: $input-feedback-padding; // avoid icon to step onto input text

        // add feedback icon
        background-image: url('../icons/#{$icon}.svg');
        background-repeat: no-repeat;
        background-position: 99.5% center;
        background-size: $input-feedback-padding;

        &:focus {
            border-color: $color-dark;
            box-shadow: inset 0 1px 1px rgba(0,0,0,.075),
                        0 0 $input-focus-spread $color-rgba;
        }
    }

    // feedback (text generated via javascript)
    .feedback {
        display: block;
        padding-left: $padding-base-horizontal;
        color: $color-dark;
        font-weight: $font-weight-semi-bold;
    }

    // add color to label for clarity
    label {
        color: $color-dark;
    }
}

/////////////////////////////////////////////////////////////
// Classes

.form-control {
    display: block;
    width: 100%;
    padding: $btn-padding-vertical $padding-base-horizontal; // same height as buttons
    font-size: $input-font-size;
    line-height: $line-height-base;
    color: $font-color-base;
    background-color: $input-bg;
    background-image: none; // Reset unusual Firefox-on-Android default style; see https://github.com/necolas/normalize.css/issues/214
    border: 1px solid $input-border;
    border-radius: $radius; // Note: This has no effect on <select>s in some browsers, due to the limited stylability of <select>s in CSS.
    box-shadow: inset 0 1px 1px rgba(0, 0, 0, .05);

    &:focus {
        outline: 0;
        box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 3px $primary;
    }

    // Placeholder
    &::-moz-placeholder, &:-ms-input-placeholder, &::-webkit-input-placeholder {
        color: $input-color-placeholder;
    }

    // Unstyle the caret on `<select>`s in IE10+.
    &::-ms-expand {
        border: 0;
        background-color: transparent;
    }

    &[disabled], fieldset[disabled] &{
        background-color: $input-bg-disabled;
        border-color: $input-border-disabled;
        color: $input-color-disabled;
        opacity: 1; // iOS fix for unreadable disabled content; see https://github.com/twbs/bootstrap/issues/11655
        cursor: not-allowed;

        // add disabled state icon
        background-image: url('../icons/not-allowed.svg');
        background-repeat: no-repeat;
        background-position: 99.5% center;
        background-size: $input-feedback-padding;
    }
}

.input-group {
    &.success-feedback { @include input-group-feedback($color: $success, $icon: "success"); }
    &.warning-feedback { @include input-group-feedback($color: $warning, $icon: "warning"); }
    &.error-feedback { @include input-group-feedback($color: $error, $icon: "alert"); }
}

// add some bottom space on form groups
.form-group {
    margin-bottom: $font-size-base;
}

// dropdown (select elements are way too complicated to be styled)
.dropdown {
    position: relative;

    .dropdown-trigger {
        position: relative;
        text-align: left;
        min-width: 300px;
        padding: $btn-padding-vertical $btn-padding-horizontal/2;

        &:after {
            font-family: 'icomoon';
            content: $icon-arrow-down;
            position: absolute;
            right: $padding-base-horizontal;
        }
    }

    .dropdown-list {
        margin-top: $padding-base-horizontal;
        padding: 0;
        min-width: 300px;
        background-color: $primary-faded;
        font-size: $font-size-base;
        border-radius: $radius;
        box-shadow: 0 6px 12px rgba(0,0,0,.175);
        position: absolute;
        top: 100%;
        left: 0;
        z-index: 1;
        display: none;
        float: left;
        text-align: left;
        list-style: none;
        background-clip: padding-box;

        li {
            &:first-of-type {
                a {
                    border-top-left-radius: $radius;
                    border-top-right-radius: $radius;
                }
            }

            &:last-of-type {
                a {
                    border-bottom-left-radius: $radius;
                    border-bottom-right-radius: $radius;
                }
            }

            &.active {
                a {
                    color: #fff;
                    background-color: $secondary;
                }
            }

            a {
                color: $font-color-base;
                padding: 6px 20px;
                display: block;
                text-decoration: none;

                &:hover, &:focus {
                    color: $font-color-base;
                    background-color: $grey;
                }

                &:active {
                    color: #fff;
                    background-color: $secondary;
                }
            }
        }
    }
}
